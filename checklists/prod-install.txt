#assuming you have a slice and are logged in
# as root.

-- Change the DNS settings to point to the new IP
-- Create a user, change depending on the username you want

> adduser --home /home/sean --shell /bin/bash sean

-- add nano as default editor, add this line to ~/.bashrc
export EDITOR="nano"

-- start visudo
> visudo

-- add the 'sean' line after the root line
root    ALL=(ALL) ALL
sean    ALL=(ALL) ALL

-- logout as root, login as new user
> exit
> ssh sean@ip.address.com

-- disable root
sudo usermod -p '!' root

-- copy public ssh key, from local machine:
>scp id_rsa.pub sean@the.ip.address:/tmp/id_rsa.pub
>ssh sean@the.ip.address
>cd ~
>mkdir .ssh
>cd .ssh
>touch authorized_keys
>cat /tmp/id_rsa.pub >> authorized_keys 
>exit
>ssh sean@the.ip.address
# should be logged in without entering password.

-- install some software
> sudo apt-get update
> sudo apt-get install emacs
> sudo apt-get install postgresql
> sudo apt-get install gcc
> sudo apt-get install python-dev
> sudo apt-get install libpq-dev
> sudo apt-get install libncurses-dev
> sudo apt-get install apache2-mpm-prefork
> sudo apt-get install libapache2-mod-python
> cd /tmp
> wget http://peak.telecommunity.com/dist/ez_setup.py
> sudo pyton ez_setup.py
> sudo easy_install virtualenv
> sudo easy_install pip
> wget http://pylockfile.googlecode.com/files/lockfile-0.9.tar.gz
> tar -xvf lockfile-0.9.tar.gz 
> cd lockfile-0.9
> sudo python setup.py install
> cd ~
> sudo pip install lamson
> sudo pip install django
> sudo pip install psycopg2
> sudo pip install beautifulsoup
> sudo pip install ipython
> sudo pip install readline
> sudo -u postgres createdb lookout

-- copy production python path file
#from local machine
scp ~/lookout/prod/python/lookout.pth sean@lookoutthere.com:/tmp
#on prod machine
sudo cp /tmp/lookout.pth /usr/local/lib/python2.6/dist-packages/

-- update postgres hba conf file
>sudo emacs /etc/postgresql/8.4/main/pg_hba.conf

#comment out this line
local   all         postgres                          ident  

>sudo /etc/init.d/postgresql-8.4 restart

-- update database schema
> cd /var/lookout/www/webapp
> python manage.py syncdb

-- Create directories for apache
> sudo mkdir /var/lookout
> sudo mkdir /var/lookout/snapshots
> sudo rm /var/www/index.html
> cd /var/www
> sudo ln -s /usr/local/lib/python2.6/dist-packages/django/contrib/admin/media/ media
> sudo ln -s /var/lookout/www/media/ static
> sudo emacs /etc/apache2/apache2.conf

-- copy apache config files
#from local machine
> cd ~/lookout/prod/apache
> scp apache2.conf sean@lookoutthere.com:/tmp
> scp lookout sean@lookoutthere.com:/tmp
> ssh sean@lookoutthere.com
> cd /etc/apache2
> sudo cp /tmp/apache2.conf .
> cd sites-available
> sudo cp /tmp/lookout .
> sudo a2dissite default
> sudo a2ensite lookout
> sudo apache2ctl restart

